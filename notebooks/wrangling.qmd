---
title: "Depression among patients living with diabetes - Wrangling"
author: "Eric Anku"
format: html
---

```{r import-libraries}
pacman::p_load(
  tidyverse, # Data wrangling
  foreign, # Load SPSS dataset
  janitor, # Clean data
  rio, # Import and Export dataset
  here, # File management
  skimr, # Skim data
  finalfit # Labelling data
)
```

```{r import-dataset}
df <- import(here("data", "data.sav"))
head(df)
```

```{r mutate-depression-functionality}
df <- df |>
  mutate(
    functionality = (
      ff1 + ff2 + ff3 + ff4 + ff5
    ) |>
      ff_label("Family fuctionality"),
    depression = (
      phq1 + phq2 + phq3 + phq4 + phq5 + phq6 + phq7 + phq8 + phq9
    ) |>
      ff_label("Depression assessment")
  )
```


```{r characterise-labels}
df <- characterize(df)
df <- factorize(df, coerce_character = TRUE)
head(df)
```

```{r glimpse-data}
glimpse(df)
```
```{r skim-data}
skim(df)
```
```{r}
df |>
  mutate(
    bmi = body_weight / (height)**2 |>
      ff_label("Body mass index (kg/m^2"),
    whr = waist_circumference / hip_circumference |>
      ff_label("Waist-to-hip ratio"),
    sbp = bp_sbp2 + bp_sbp3 / 2 |>
      ff_label("Systolic blood pressure (mmHg)"),
    dbp = bp_dbp2 + bp_dbp3 / 2 |>
      ff_label("Diastolic blood pressure (mmHg)"),
    ff_label(age, "Age (years)"),
    ff_label(sex, "Sex"),
    ff_label(education, "Educational status"),
    ff_label(marital_status, "Marital status"),
    ff_label(religious_background, "Religious background"),
    ff_label(employment_status, "Employment status"),
    ff_label(place_of_permanent_residence, "Place of permanent residence"),
    ff_label(monthly_income, "Monthly income (Ghana cedis)"),
    ff_label(hba1c_value, "HBA1C (%)"),
    ff_label(body_weight, "Weight (kg)"),
    ff_label(height, "Height (cm)"),
    ff_label(waist_circumference, "Waist circumference"),
    ff_label(hip_circumference, "Hip circumference"),
    ff_label(duration_diabetes, "Duration of diabetes"),
    ff_label(treatment_diabetes, "Treatment of diabetes"),
    
    
  )
```


